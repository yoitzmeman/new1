mapper.py

import sys
import csv

for line in csv.reader(iter(sys.stdin.readline, '')):
    year = line[0]
    sales = line[2]
    print(f"{year}\t{sales}")


reducer.py

import sys
current_year = None
total_sales = 0

for line in sys.stdin:
    year, sales = line.strip().split('\t')

    if current_year is None:
        current_year = year

    try:
        sales_value = int(sales)
    except:
        print("Ignoring non-numeric sales value for the year {year}: {sales})
        continue

    if year == current_year:
        total_sales += sales_value
    else:
        print(f"{current_year}\t{total_sales}")
        current_year = year
        total_sales = sales_value

if current_year is not None:
    print(f"{current_year}\t{total_sales}")


input.txt

input.txt
2018    Jan 10000
2018    Feb 12000
2018    Mar 15000
2019    Jan 20000
2019    Feb 22000
2019    Mar 25000
2020    Jan 30000
2020    Feb 32000
2020    Mar 35000
2018    gyu 500000
2019    uyt 750000

$cat input.txt | python3 mapper.py | sort | python3 reducer.py

1. sudo su hduser
2. start-dfs.sh
3. start-yarn.sh
4. jps
5. hdfs dfs -put /input.txt /
6. hadoop jar /usr/local/hadoop/share/hadoop/tools/lib/hadoop-streaming 3.3.4.jar -files
./mapper.py,./reducer.py -mapper "python3 mapper.py" -reducer "python3 reducer.py" -input
/5000-8.txt -output /0000009
7. Observe the result in localhost:9870
8. Download outputfile and view it for wordcount